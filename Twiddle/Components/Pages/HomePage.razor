@page "/HomePage"
@using Twiddle.Components.ViewModels

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #fffbf0;
        color: #333;
        line-height: 1.6;
    }

    .container {
        display: flex;
        min-height: 100vh;
        max-width: 1200px;
        margin: 0 auto;
    }

    /* Sidebar */
    .sidebar {
        width: 280px;
        background: #fefdf8;
        border-right: 1px solid #eee;
        padding: 20px;
        position: sticky;
        top: 0;
        height: 100vh;
        overflow-y: auto;
    }

    .logo {
        font-size: 24px;
        font-weight: 700;
        color: #FFB300;
        margin-bottom: 30px;
        text-align: center;
    }

    .profile-section {
        background: #fff;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(255, 179, 0, 0.1);
        margin-bottom: 20px;
        cursor: pointer;
        transition: all 0.3s;
    }

        .profile-section:hover {
            box-shadow: 0 6px 20px rgba(255, 179, 0, 0.15);
            transform: translateY(-2px);
        }

    .profile-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #FFB300, #FF8F00);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: 600;
        margin: 0 auto 15px;
    }

    .profile-info {
        text-align: center;
    }

    .profile-name {
        font-weight: 600;
        font-size: 16px;
        margin-bottom: 5px;
    }

    .profile-username {
        color: #666;
        font-size: 14px;
    }

    .nav-menu {
        list-style: none;
    }

    .nav-item {
        margin-bottom: 10px;
    }

    .nav-link {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        text-decoration: none;
        color: #555;
        border-radius: 8px;
        transition: all 0.3s;
        font-weight: 500;
    }

        .nav-link:hover, .nav-link.active {
            background: #FFB300;
            color: white;
            transform: translateX(5px);
        }

    .nav-icon {
        margin-right: 15px;
        font-size: 18px;
    }

    /* Main Content */
    .main-content {
        flex: 1;
        background: #fff;
        border-right: 1px solid #eee;
    }

    .header {
        background: #fefdf8;
        padding: 20px;
        border-bottom: 1px solid #eee;
        position: sticky;
        top: 0;
        z-index: 100;
    }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

    /* Tweet Composer */
    .tweet-composer {
        background: #fefdf8;
        border-bottom: 1px solid #eee;
        padding: 20px;
    }

    .composer-form {
        display: flex;
        gap: 15px;
    }

    .composer-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: linear-gradient(135deg, #FFB300, #FF8F00);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 18px;
        flex-shrink: 0;
    }

    .composer-content {
        flex: 1;
    }

    .composer-textarea {
        width: 100%;
        border: none;
        outline: none;
        font-size: 18px;
        font-family: inherit;
        resize: none;
        min-height: 80px;
        padding: 10px 0;
        background: transparent;
        color: #333;
    }

        .composer-textarea::placeholder {
            color: #999;
        }

    .composer-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #eee;
    }

    .composer-options {
        display: flex;
        gap: 15px;
    }

    .option-btn {
        background: none;
        border: none;
        color: #FFB300;
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: all 0.3s;
    }

        .option-btn:hover {
            background: rgba(255, 179, 0, 0.1);
        }

    .tweet-btn {
        background: #FFB300;
        color: white;
        border: none;
        padding: 8px 20px;
        border-radius: 20px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }

        .tweet-btn:hover {
            background: #FF8F00;
            transform: translateY(-1px);
        }

        .tweet-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

    /* Feed */
    .feed {
        background: #fff;
    }

    .tweet {
        border-bottom: 1px solid #eee;
        padding: 20px;
        transition: background 0.3s;
    }

        .tweet:hover {
            background: #fefdf8;
        }

    .tweet-content {
        display: flex;
        gap: 15px;
    }

    .tweet-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: linear-gradient(135deg, #FFB300, #FF8F00);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 18px;
        flex-shrink: 0;
    }

    .tweet-body {
        flex: 1;
    }

    .tweet-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 5px;
    }

    .tweet-name {
        font-weight: 600;
        color: #333;
    }

    .tweet-username {
        color: #666;
    }

    .tweet-time {
        color: #999;
        font-size: 14px;
    }

    .tweet-text {
        margin-bottom: 15px;
        line-height: 1.5;
    }

    .tweet-actions {
        display: flex;
        gap: 20px;
    }

    .action-btn {
        background: none;
        border: none;
        color: #666;
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 5px;
    }

        .action-btn:hover {
            color: #FFB300;
            background: rgba(255, 179, 0, 0.1);
        }

        .action-btn.liked {
            color: #e74c3c;
        }

    /* Right Sidebar */
    .right-sidebar {
        width: 320px;
        padding: 20px;
        background: #fefdf8;
    }

    .trending-section {
        background: #fff;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(255, 179, 0, 0.1);
    }

    .section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: #333;
    }

    .trending-item {
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
        cursor: pointer;
        transition: background 0.3s;
    }

        .trending-item:hover {
            background: #fefdf8;
        }

        .trending-item:last-child {
            border-bottom: none;
        }

    .trending-topic {
        font-weight: 600;
        color: #333;
        margin-bottom: 2px;
    }

    .trending-count {
        color: #666;
        font-size: 14px;
    }

    @@media (max-width: 768px) {
        .container
    {
        flex-direction: column;
    }

    .sidebar, .right-sidebar {
        width: 100%;
        height: auto;
        position: static;
    }

    .sidebar {
        order: 2;
    }

    .main-content {
        order: 1;
    }

    .right-sidebar {
        order: 3;
    }

    }
</style>

<div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">Twiddle</div>

        <!-- Profile Section -->
        <div class="profile-section" @onclick="GoToProfile">
            <div class="profile-avatar">JD</div>
            <div class="profile-info">
                <div class="profile-name">John Doe</div>
                <div class="profile-username">@@johndoe</div>
            </div>
        </div>

        <!-- Navigation -->
        <nav>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active">
                        <span class="nav-icon">🏠</span>
                        For You
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="nav-icon">🔍</span>
                        Explore
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="nav-icon">🔔</span>
                        Notifications
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="nav-icon">✉️</span>
                        Messages
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="nav-icon">👤</span>
                        Profile
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <div class="header">
            <h1>For You</h1>
        </div>

        <!-- Tweet Composer -->
        <div class="tweet-composer">
            <div class="composer-form">
                <div class="composer-avatar">JD</div>
                <div class="composer-content">
                    <textarea class="composer-textarea" placeholder="What's happening?"
                              @bind="NewTweet"
                              @oninput="ResizeTextarea"></textarea>
                    <div class="composer-actions">
                        <div class="composer-options">
                            <button class="option-btn" title="Add photo">📷</button>
                            <button class="option-btn" title="Add emoji">😊</button>
                            <button class="option-btn" title="Add poll">📊</button>
                        </div>
                        <button class="tweet-btn" @onclick="PostTweet" disabled="@string.IsNullOrWhiteSpace(NewTweet)">Post</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feed -->
        <div class="feed">
            @foreach (var tweet in Tweets)
            {
                <div class="tweet">
                    <div class="tweet-content">
                        <div class="tweet-avatar" style="@($"background: {tweet.AvatarBackground}")">@tweet.AvatarInitials</div>
                        <div class="tweet-body">
                            <div class="tweet-header">
                                <span class="tweet-name">@tweet.Name</span>
                                <span class="tweet-username">@tweet.Username</span>
                                <span class="tweet-time">• @tweet.TimeAgo</span>
                            </div>
                            <div class="tweet-text">@tweet.Text</div>
                            <div class="tweet-actions">
                                <button class="action-btn @(tweet.Liked ? "liked" : "")" 
                                        @onclick="@(() => LikeTweet(tweet))">
                                    ❤️ @tweet.Likes
                                </button>
                                <button class="action-btn">💬 @tweet.Comments</button>
                                <button class="action-btn">🔄 @tweet.Retweets</button>
                                <button class="action-btn">📤</button>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </main>

    <!-- Right Sidebar -->
    <aside class="right-sidebar">
        <div class="trending-section">
            <h3 class="section-title">What's happening</h3>

            @foreach (var trend in Trending)
            {
                <div class="trending-item">
                    <div class="trending-topic">@trend.Topic</div>
                    <div class="trending-count">@trend.Count posts</div>
                </div>
            }
        </div>
    </aside>
</div>

@code {
    private string NewTweet { get; set; } = "";

    private List<TwidViewModel> Tweets { get; set; } = new()
    {
        new TwidViewModel
        {
            Name = "Alice Smith",
            Username = "@@alicesmith",
            TimeAgo = "2h",
            Text = "Just launched my new project! Excited to share it with the world 🚀 It's been months of hard work but totally worth it.",
            AvatarInitials = "AS",
            AvatarBackground = "linear-gradient(135deg, #FFB300, #FF8F00)",
            Likes = 156,
            Comments = 12,
            Retweets = 24
        },
        new TwidViewModel
        {
            Name = "Mike Brown",
            Username = "@@mikebrown",
            TimeAgo = "4h",
            Text = "Beautiful sunset today! Sometimes you need to stop and appreciate the simple things in life ✨",
            AvatarInitials = "MB",
            AvatarBackground = "linear-gradient(135deg, #e74c3c, #c0392b)",
            Likes = 89,
            Comments = 8,
            Retweets = 15
        },
        new TwidViewModel
        {
            Name = "Emily Johnson",
            Username = "@@emilyjohnson",
            TimeAgo = "6h",
            Text = "Pro tip for developers: Always write tests for your code. Your future self will thank you! #coding #development #tips",
            AvatarInitials = "EJ",
            AvatarBackground = "linear-gradient(135deg, #3498db, #2980b9)",
            Likes = 234,
            Comments = 34,
            Retweets = 67
        }
    };

    private List<TrendingViewModel> Trending { get; set; } = new()
    {
        new TrendingViewModel { Topic = "#WebDevelopment", Count = 12500 },
        new TrendingViewModel { Topic = "#MondayMotivation", Count = 8200 },
        new TrendingViewModel { Topic = "#TechNews", Count = 25100 },
        new TrendingViewModel { Topic = "#Design", Count = 15700 }
    };

    private void GoToProfile()
    {
        Console.WriteLine("Navigate to profile");
    }

    private void PostTweet()
    {
        if (!string.IsNullOrWhiteSpace(NewTweet))
        {
            Tweets.Insert(0, new TwidViewModel()
            {
                Name = "John Doe",
                Username = "@@johndoe",
                TimeAgo = "Just now",
                Text = NewTweet,
                AvatarInitials = "JD",
                AvatarBackground = "linear-gradient(135deg, #FFB300, #FF8F00)",
                Likes = 0,
                Comments = 0,
                Retweets = 0
            });

            NewTweet = "";
        }
    }

    private void LikeTweet(TwidViewModel tweet)
    {
        tweet.Liked = !tweet.Liked;
        tweet.Likes += tweet.Liked ? 1 : -1;
    }

    private void ResizeTextarea(ChangeEventArgs e)
    {
        // Optional: Auto-resize can be handled via CSS only if desired
    }
}